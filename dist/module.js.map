{"version":3,"sources":["../src/module.js"],"names":["MetricsPanelCtrl","$","_","moment","d3","appEvents","MultistatPanelCtrl","$scope","$injector","panelDefaults","panel","elem","ctrl","defaults","events","on","onRender","bind","onDataReceived","onDataError","onInitEditMode","className","id","err","seriesList","data","displayStatusMessage","status","statusText","metricNames","sortDirections","aggregations","fontSizes","valuePositions","curveTypes","addEditorTab","cols","length","rows","type","columns","i","text","cols0","concat","render","emit","dateTimeCol","$title","closest","find","$maxDate","append","children","last","ShowDate","maxDate","dd","add","TZOffsetHours","DateFormat","toUpperCase","fromNow","show","format","hide","msg","html","labelCol","valueCol","sortCol","groupCol","DateTimeColName","LabelColName","ValueColName","SortColName","GroupColName","LabelNameFilter","regex","RegExp","matchingRows","label","match","push","Aggregate","oo","nest","key","d","rollup","entries","forEach","x","value","Object","values","assign","mean","Array","from","max","min","groupNameOffset","ShowGroupLabels","Number","GroupLabelFontSize","replace","groupedRows","GroupNameFilter","regexGroupRows","matchingGroups","groupName","groupSortString","GroupSortString","sort","a","b","aPos","search","bPos","localeCompare","SortDirection","ascending","y","comp","$container","h","height","w","width","buildDateHtml","horizontal","Horizontal","labelMargin","isNumeric","LabelMargin","lowSideMargin","LowSideMargin","highSideMargin","HighSideMargin","svg","select","selectAll","interrupt","barPadding","BarPadding","baseLineValue","BaseLineValue","minLineValue","MinLineValue","maxLineValue","MaxLineValue","highBarColor","HighBarColor","lowBarColor","LowBarColor","highLimitValue","HighLimitValue","HighLimitBarColor","HighLimitBarFlashColor","HighLimitBarFlashTimeout","recolorHighLimitBar","RecolorHighLimitBar","lowLimitValue","LowLimitValue","LowLimitBarColor","LowLimitBarFlashColor","LowLimitBarFlashTimeout","recolorLowLimitBar","RecolorLowLimitBar","flashHighLimitBar","FlashHighLimitBar","flashLowLimitBar","FlashLowLimitBar","showTooltips","ShowTooltips","TooltipDateFormat","ValueDecimals","OddRowColor","EvenRowColor","GroupCols","GroupGap","ScaleFactor","LabelColor","ValuePosition","DisplayMode","minValue","maxValue","attr","style","tooltipShow","c","tooltipDiv","transition","duration","cc","toFixed","event","pageX","pageY","tooltipHide","scaleAndClipValue","val","plotGroupHorizontal","numRows","left","hh","dh","GroupLabelColor","labels","map","Math","random","toString","substr","labelScale","scaleBand","domain","rangeRound","paddingInner","paddingOuter","stripedata","range","stripeScale","oddeven","enter","step","g1","ShowValues","maxValueWidth","bandwidth","ValueFontSize","ValueColor","each","thisWidth","getComputedTextLength","ShowLabels","maxLabelWidth","labelAngle","LableAngle","LabelFontSize","OutOfRangeLabelColor","bbox","getBBox","s","sin","PI","cos","abs","valueScale","scaleLinear","nice","vLine","color","strokeWidth","ShowBaseLine","BaseLineColor","BaseLineWidth","ShowMaxLine","MaxLineColor","MaxLineWidth","ShowMinLine","MinLineColor","MinLineWidth","ShowHighLimitLine","HighLimitLineColor","HighLimitLineWidth","ShowLowLimitLine","LowLimitLineColor","LowLimitLineWidth","ShowBars","classed","ShowLines","LineWidth","points","bw","curveFunc","curveLinear","CurveType","curveMonotoneY","curveCardinal","curveCatmullRom","lineFunction","line","curve","lineGraph","LineColor","DotSize","DotColor","ggHighSide","call","axisTop","HighAxisColor","HighAxisWidth","ggLowSide","axisBottom","LowAxisColor","LowAxisWidth","gcols","dw","pointsPerRow","rr","floor","u","totalPoints","rowOverheadHeight","rowHeight","ceil","nn","ii","plotGroupVertical","g2","maxValueHeight","thisHeight","maxLabelHeight","hLine","curveMonotoneX","axisLeft","tickSizeInner","tickSizeOuter","ticks","axisRight","pointsPerCol","colOverheadWidth","colWidth","ww","pulseHigh","highFlashRects","_groups","highRepeat","active","pulseLow","lowFlashRects","lowRepeat","renderingCompleted","refresh","scope","attrs","panelContentElem","templateUrl"],"mappings":"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","file":"module.js","sourcesContent":["/*jshint esversion: 6 */\r\nimport {\r\n\tMetricsPanelCtrl\r\n} from 'app/plugins/sdk';\r\nimport $ from 'jquery';\r\nimport 'jquery.flot';\r\nimport _ from 'lodash';\r\nimport moment from 'moment';\r\nimport \"./css/multistat-panel.css!\";\r\nimport d3 from './external/d3';\r\nimport {\r\n\tappEvents\r\n} from 'app/core/core';\r\n\r\nclass MultistatPanelCtrl extends MetricsPanelCtrl {\r\n\r\n\t/** @ngInject */\r\n\tconstructor($scope, $injector) {\r\n\t\t\tsuper($scope, $injector);\r\n\r\n\t\t\tvar panelDefaults = {\r\n\t\t\t\t\t\"BarPadding\": 10,\r\n\t\t\t\t\t\"BaseLineColor\": \"#ff0000\",\r\n\t\t\t\t\t\"BaseLineWidth\": 1,\r\n\t\t\t\t\t\"BaseLineValue\": 0,\r\n\t\t\t\t\t\"DateTimeColName\": \"date\",\r\n\t\t\t\t\t\"DateFormat\": \"YYYY-MM-DD HH:mm:ss\",\r\n\t\t\t\t\t\"TooltipDateFormat\": \"YYYY-MM-DD HH:mm:ss\",\r\n\t\t\t\t\t\"FlashHighLimitBar\": false,\r\n\t\t\t\t\t\"FlashLowLimitBar\": false,\r\n\t\t\t\t\t\"HighAxisColor\": \"#ffffff\",\r\n\t\t\t\t\t\"HighAxisWidth\": 1,\r\n\t\t\t\t\t\"HighBarColor\": \"rgb(120, 128, 0)\",\r\n\t\t\t\t\t\"HighLimitBarColor\": \"#ff0000\",\r\n\t\t\t\t\t\"HighLimitBarFlashColor\": \"#ffa500\",\r\n\t\t\t\t\t\"HighLimitBarFlashTimeout\": 1000,\r\n\t\t\t\t\t\"HighLimitLineColor\": \"#ff0000\",\r\n\t\t\t\t\t\"HighLimitValue\": 0.33,\r\n\t\t\t\t\t\"HighLmitLineWidth\": 1,\r\n\t\t\t\t\t\"HighSideMargin\": 22,\r\n\t\t\t\t\t\"Horizontal\": false,\r\n\t\t\t\t\t\"LabelColName\": \"sensor\",\r\n\t\t\t\t\t\"LabelNameFilter\": \"\",\r\n\t\t\t\t\t\"LabelColor\": \"#ffffff\",\r\n\t\t\t\t\t\"OutOfRangeLabelColor\": \"#ffffff\",\r\n\t\t\t\t\t\"GroupLabelColor\": \"#ffffff\",\r\n\t\t\t\t\t\"LabelFontSize\": \"100%\",\r\n\t\t\t\t\t\"GroupLabelFontSize\": \"200%\",\r\n\t\t\t\t\t\"GroupGap\": 5,\r\n\t\t\t\t\t\"LabelMargin\": null,\r\n\t\t\t\t\t\"LowAxisColor\": \"#ffffff\",\r\n\t\t\t\t\t\"LowAxisWidth\": 1,\r\n\t\t\t\t\t\"LowBarColor\": \"teal\",\r\n\t\t\t\t\t\"LowLimitBarColor\": \"#ff0000\",\r\n\t\t\t\t\t\"LowLimitBarFlashColor\": \"#ffa500\",\r\n\t\t\t\t\t\"LowLimitBarFlashTimeout\": 200,\r\n\t\t\t\t\t\"LowLimitLineColor\": \"#ff0000\",\r\n\t\t\t\t\t\"LowLimitValue\": null,\r\n\t\t\t\t\t\"LowLmitLineWidth\": 1,\r\n\t\t\t\t\t\"LowSideMargin\": 22,\r\n\t\t\t\t\t\"MaxLineColor\": \"rgb(74, 232, 12)\",\r\n\t\t\t\t\t\"MaxLineWidth\": 1,\r\n\t\t\t\t\t\"MaxLineValue\": 1,\r\n\t\t\t\t\t\"MinLineColor\": \"#ff0000\",\r\n\t\t\t\t\t\"MinLineWidth\": 1,\r\n\t\t\t\t\t\"MinLineValue\": 0,\r\n\t\t\t\t\t\"RecolorHighLimitBar\": true,\r\n\t\t\t\t\t\"RecolorLowLimitBar\": false,\r\n\t\t\t\t\t\"ShowBaseLine\": true,\r\n\t\t\t\t\t\"ShowDate\": false,\r\n\t\t\t\t\t\"Aggregate\": \"last\",\r\n\t\t\t\t\t\"ShowHighLimitLine\": true,\r\n\t\t\t\t\t\"ShowLabels\": true,\r\n\t\t\t\t\t\"ShowGroupLabels\": true,\r\n\t\t\t\t\t\"ShowLeftAxis\": true,\r\n\t\t\t\t\t\"ShowLowLimitLine\": false,\r\n\t\t\t\t\t\"ShowMaxLine\": false,\r\n\t\t\t\t\t\"ShowMinLine\": true,\r\n\t\t\t\t\t\"ShowRightAxis\": true,\r\n\t\t\t\t\t\"ShowTooltips\": true,\r\n\t\t\t\t\t\"ShowValues\": true,\r\n\t\t\t\t\t\"SortColName\": \"value\",\r\n\t\t\t\t\t\"SortDirection\": \"ascending\",\r\n\t\t\t\t\t\"TZOffsetHours\": 0,\r\n\t\t\t\t\t\"ValueColName\": \"value\",\r\n\t\t\t\t\t\"ValueDecimals\": 2,\r\n\t\t\t\t\t\"ValueColor\": \"#ffffff\",\r\n\t\t\t\t\t\"ValueFontSize\": \"100%\",\r\n\t\t\t\t\t\"OddRowColor\": \"rgba(33, 33, 34, 0.92)\",\r\n\t\t\t\t\t\"EvenRowColor\": \"rgba(61, 61, 64, 0.78)\",\r\n\t\t\t\t\t\"GroupSortString\": \"\",\r\n\t\t\t\t\t\"GroupCols\": 0,\r\n\t\t\t\t\t\"GroupNameFilter\": \"\",\r\n\t\t\t\t\t\"ScaleFactor\": 1.0,\r\n\t\t\t\t\t\"ValuePosition\": \"top\",\r\n\t\t\t\t\t\"LableAngle\": 0,\r\n\t\t\t\t\t\"ShowBars\": true,\r\n\t\t\t\t\t\"ShowLines\": false,\r\n\t\t\t\t\t\"LineWidth\": 5,\r\n\t\t\t\t\t\"LineColor\": \"blue\",\r\n\t\t\t\t\t\"DotSize\": 10,\r\n\t\t\t\t\t\"DotColor\": \"white\",\r\n\t\t\t\t\t\"CurveType\": \"Monotone\"\r\n\t\t\t};\r\n\r\n\t\t\tvar panel = {};\r\n\t\t\tvar elem = {};\r\n\t\t\tvar ctrl = {};\r\n\r\n\t\t\t_.defaults(this.panel, panelDefaults);\r\n\r\n\t\t\tthis.events.on('render', this.onRender.bind(this));\r\n\t\t\tthis.events.on('data-received', this.onDataReceived.bind(this));\r\n\t\t\tthis.events.on('data-error', this.onDataError.bind(this));\r\n\t\t\tthis.events.on('init-edit-mode', this.onInitEditMode.bind(this));\r\n\r\n\t\t\tthis.className = 'michaeldmoore-multistat-panel-' + this.panel.id;\r\n\t}\r\n\r\n\tonDataError(err) {\r\n\t\t\tthis.seriesList = [];\r\n\t\t\tthis.data = [];\r\n\t\t\tthis.displayStatusMessage(\"Query failure, Status=\" + err.status + \", \" + err.statusText);\r\n\t}\r\n\r\n\tonInitEditMode() {\r\n\t\t\tthis.metricNames = ['min', 'max', 'avg', 'current', 'total', 'name', 'first', 'delta', 'diff', 'range'];\r\n\t\t\tthis.sortDirections = ['none', 'ascending', 'descending'];\r\n\t\t\tthis.aggregations = ['all', 'last', 'first', 'mean', 'max', 'min'];\r\n\t\t\tthis.fontSizes = ['20%', '30%', '50%', '70%', '80%', '100%', '110%', '120%', '150%', '170%', '200%', '250%', '300%', '350%', '400%'];\r\n\t\t\tthis.valuePositions = ['bar base', 'bar end', 'top'];\r\n\t\t\tthis.curveTypes = ['Linear', 'Monotone', 'Cardinal', 'Catmull-Rom'];\r\n\t\t\tthis.addEditorTab('Columns', 'public/plugins/michaeldmoore-multistat-panel/columns.html', 2);\r\n\t\t\tthis.addEditorTab('Layout', 'public/plugins/michaeldmoore-multistat-panel/layout.html', 3);\r\n\t\t\tthis.addEditorTab('Grouping', 'public/plugins/michaeldmoore-multistat-panel/grouping.html', 4);\r\n\t\t\tthis.addEditorTab('Options', 'public/plugins/michaeldmoore-multistat-panel/options.html', 5);\r\n\t\t\tthis.addEditorTab('Lines-and-Limits', 'public/plugins/michaeldmoore-multistat-panel/linesandlimits.html', 6);\r\n\t}\r\n\r\n\tonDataReceived(data) {\r\n\t\t\tthis.cols = [];\r\n\t\t\t// console.log('onDataReceived(' + JSON.stringify(data) + ')');\r\n\t\t\tif (data.length == 0) {\r\n\t\t\t\t\tthis.displayStatusMessage(\"No data to show\");\r\n\t\t\t\t\tthis.data = data;\r\n\t\t\t\t\tthis.rows = null;\r\n\t\t\t} else if (data[0].type == \"table\" || data[0].columns) {\r\n\t\t\t\t\tthis.data = data[0];\r\n\r\n\t\t\t\t\tfor (let i = 0; i < this.data.columns.length; i++)\r\n\t\t\t\t\t\t\tthis.cols[i] = this.data.columns[i].text;\r\n\t\t\t\t\tthis.cols0 = [''].concat(this.cols);\r\n\r\n\t\t\t\t\tthis.render();\r\n\t\t\t} else {\r\n\t\t\t\t\tappEvents.emit('alert-error', ['Non-Table type data received', 'Multistat does not support Time Series data sets']);\r\n\t\t\t}\r\n\t}\r\n\r\n\tbuildDateHtml(dateTimeCol) {\r\n\t\t\tvar $title = this.elem.closest('.panel-container').find('.panel-title');\r\n\t\t\tvar $maxDate = $title.find('span.michaeldmoore-multistat-panel-maxDate');\r\n\r\n\t\t\tif ($maxDate.length == 0)\r\n\t\t\t\t\t$maxDate = $title.append('<span class=\"michaeldmoore-multistat-panel-maxDate\"/>').children().last();\r\n\r\n\t\t\tif (dateTimeCol != -1 && this.panel.ShowDate) {\r\n\t\t\t\t\tvar maxDate = this.rows[0][dateTimeCol];\r\n\r\n\t\t\t\t\tfor (let i = 1; i < this.rows.length; i++) {\r\n\t\t\t\t\t\t\tif (maxDate < this.rows[i][dateTimeCol])\r\n\t\t\t\t\t\t\t\t\tmaxDate = this.rows[i][dateTimeCol];\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar dd = moment(maxDate).add(this.panel.TZOffsetHours, 'h');\r\n\r\n\t\t\t\t\tif (this.panel.DateFormat.toUpperCase() == 'ELAPSED')\r\n\t\t\t\t\t\t\t$maxDate.text(dd.fromNow()).show();\r\n\t\t\t\t\telse\r\n\t\t\t\t\t\t\t$maxDate.text(dd.format(this.panel.DateFormat)).show();\r\n\t\t\t} else\r\n\t\t\t\t\t$maxDate.hide();\r\n\t}\r\n\r\n\tdisplayStatusMessage(msg) {\r\n\t\t\tthis.elem.html(\"<div class='michaeldmoore-multistat-panel-statusmessage'>\" + msg + \"</div>\");\r\n\t}\r\n\r\n\tonRender() {\r\n\t\t\tif (this.data != null && this.data.rows != null) {\r\n\t\t\t\t\tvar cols = this.cols;\r\n\t\t\t\t\tvar dateTimeCol = -1;\r\n\t\t\t\t\tvar labelCol = -1;\r\n\t\t\t\t\tvar valueCol = 0;\r\n\t\t\t\t\tvar sortCol = 0;\r\n\t\t\t\t\tvar groupCol = -1;\r\n\t\t\t\t\tfor (let i = 0; i < cols.length; i++) {\r\n\t\t\t\t\t\t\tif (cols[i] == this.panel.DateTimeColName)\r\n\t\t\t\t\t\t\t\t\tdateTimeCol = i;\r\n\t\t\t\t\t\t\tif (cols[i] == this.panel.LabelColName)\r\n\t\t\t\t\t\t\t\t\tlabelCol = i;\r\n\t\t\t\t\t\t\tif (cols[i] == this.panel.ValueColName)\r\n\t\t\t\t\t\t\t\t\tvalueCol = i;\r\n\t\t\t\t\t\t\tif (cols[i] == this.panel.SortColName)\r\n\t\t\t\t\t\t\t\t\tsortCol = i;\r\n\t\t\t\t\t\t\tif (cols[i] == this.panel.GroupColName)\r\n\t\t\t\t\t\t\t\t\tgroupCol = i;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this.panel.LabelNameFilter.length > 0 && labelCol != -1) {\r\n\t\t\t\t\t\t\tvar regex = new RegExp(this.panel.LabelNameFilter, \"\");\r\n\t\t\t\t\t\t\tthis.matchingRows = [];\r\n\t\t\t\t\t\t\tfor (let i = 0; i < this.data.rows.length; i++) {\r\n\t\t\t\t\t\t\t\t\tvar dd = this.data.rows[i];\r\n\t\t\t\t\t\t\t\t\tvar label = dd[labelCol];\r\n\t\t\t\t\t\t\t\t\tif (label.match(regex) != null)\r\n\t\t\t\t\t\t\t\t\t\t\tthis.matchingRows.push(dd);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (this.matchingRows.length == 0) {\r\n\t\t\t\t\t\t\t\t\tthis.displayStatusMessage(\"No data.  Regex filter '\" + this.panel.LabelNameFilter + \"' eliminated all \" + this.data.rows.length + \" rows from current query\");\r\n\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t} else\r\n\t\t\t\t\t\t\tthis.matchingRows = this.data.rows;\r\n\r\n\t\t\t\t\tif (this.panel.Aggregate != 'all' && labelCol != -1) {\r\n\t\t\t\t\t\t\tvar oo = [];\r\n\t\t\t\t\t\t\tthis.rows = [];\r\n\t\t\t\t\t\t\tswitch (this.panel.Aggregate) {\r\n\t\t\t\t\t\t\t\t\tcase 'first':\r\n\t\t\t\t\t\t\t\t\t\t\tthis.rows = d3.nest()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.key(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d[labelCol];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.rollup(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d[0];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.entries(this.matchingRows)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.forEach(function(x) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\too.push(x.value);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\tthis.rows = oo;\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\tcase 'last':\r\n\t\t\t\t\t\t\t\t\t\t\tthis.rows = d3.nest()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.key(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d[labelCol];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.rollup(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d[d.length - 1];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.entries(this.matchingRows)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.forEach(function(x) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\too.push(x.value);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\tthis.rows = oo;\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\tcase 'mean':\r\n\t\t\t\t\t\t\t\t\t\t\tthis.rows = d3.nest()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.key(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d[labelCol];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.rollup(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar dd = Object.values(Object.assign({}, d[d.length - 1]));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdd[valueCol] = d3.mean(d, function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d[valueCol];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn dd;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.entries(this.matchingRows)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.forEach(function(x) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\too.push(x.value);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\tthis.rows = Array.from(oo);\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\tcase 'max':\r\n\t\t\t\t\t\t\t\t\t\t\tthis.rows = d3.nest()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.key(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d[labelCol];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.rollup(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar dd = Object.values(Object.assign({}, d[d.length - 1]));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdd[valueCol] = d3.max(d, function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d[valueCol];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn dd;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.entries(this.matchingRows)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.forEach(function(x) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\too.push(x.value);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\tthis.rows = Array.from(oo);\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\t\t\t\tcase 'min':\r\n\t\t\t\t\t\t\t\t\t\t\tthis.rows = d3.nest()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.key(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d[labelCol];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.rollup(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar dd = Object.values(Object.assign({}, d[d.length - 1]));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdd[valueCol] = d3.min(d, function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d[valueCol];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn dd;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.entries(this.matchingRows)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.forEach(function(x) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\too.push(x.value);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\tthis.rows = Array.from(oo);\r\n\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.rows = this.matchingRows;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar groupNameOffset = this.panel.ShowGroupLabels ? Number(this.panel.GroupLabelFontSize.replace('%', '')) * 0.15 : 0;\r\n\r\n\t\t\t\t\tif (groupCol >= 0) {\r\n\t\t\t\t\t\t\tthis.groupedRows = d3.nest()\r\n\t\t\t\t\t\t\t\t\t.key(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\treturn d[groupCol];\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t.entries(this.rows);\r\n\r\n\t\t\t\t\t\t\tif (this.panel.GroupNameFilter.length > 0) {\r\n\t\t\t\t\t\t\t\t\tvar regexGroupRows = new RegExp(this.panel.GroupNameFilter, \"\");\r\n\t\t\t\t\t\t\t\t\tlet matchingGroups = [];\r\n\t\t\t\t\t\t\t\t\tfor (let i = 0; i < this.groupedRows.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\t\tlet groupName = this.groupedRows[i].key;\r\n\t\t\t\t\t\t\t\t\t\t\tif (groupName.match(regexGroupRows) != null)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tmatchingGroups.push(this.groupedRows[i]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (matchingGroups.length > 0)\r\n\t\t\t\t\t\t\t\t\t\t\tthis.groupedRows = matchingGroups;\r\n\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\tthis.displayStatusMessage(\"No groups.  Group Regex filter '\" + this.panel.GroupNameFilter + \"' eliminated all \" + this.groupedRows.length + \" groups from current query\");\r\n\t\t\t\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tlet groupSortString = this.panel.GroupSortString;\r\n\r\n\t\t\t\t\t\t\tthis.groupedRows.sort(\r\n\t\t\t\t\t\t\t\t\tfunction(a, b) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar aPos = groupSortString.search(a.key);\r\n\t\t\t\t\t\t\t\t\t\t\tvar bPos = groupSortString.search(b.key);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif (aPos == bPos)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn a.key.localeCompare(b.key);\r\n\t\t\t\t\t\t\t\t\t\t\telse if (aPos == -1)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t\t\t\t\t\telse if (bPos == -1)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn aPos - bPos;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.groupedRows = null;\r\n\r\n\t\t\t\t\t\t\tif (this.panel.SortDirection != \"none\") {\r\n\t\t\t\t\t\t\t\t\tvar ascending = this.panel.SortDirection == \"ascending\";\r\n\t\t\t\t\t\t\t\t\tthis.rows.sort(function(x, y) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar comp = (x[sortCol] == y[sortCol]) ? 0 : ((x[sortCol] > y[sortCol]) ? 1 : -1);\r\n\t\t\t\t\t\t\t\t\t\t\treturn ascending ? comp : -comp;\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.elem.html(\"<svg class='\" + this.className + \"'  style='height:100%; width:100%'></svg>\");\r\n\t\t\t\t\tvar $container = this.elem.find('.' + this.className);\r\n\r\n\t\t\t\t\tvar h = $container.height();\r\n\t\t\t\t\tvar w = $container.width() - 15;\r\n\t\t\t\t\tthis.buildDateHtml(dateTimeCol);\r\n\r\n\t\t\t\t\tvar horizontal = this.panel.Horizontal;\r\n\r\n\t\t\t\t\tvar labelMargin = ($.isNumeric(this.panel.LabelMargin) && this.panel.LabelMargin >= 0) ? this.panel.LabelMargin : null;\r\n\t\t\t\t\tvar lowSideMargin = this.panel.LowSideMargin >= 0 ? this.panel.LowSideMargin : 0;\r\n\t\t\t\t\tvar highSideMargin = this.panel.HighSideMargin >= 0 ? this.panel.HighSideMargin : 0;\r\n\r\n\t\t\t\t\tthis.svg = d3.select('.' + this.className).append('svg');\r\n\t\t\t\t\tthis.svg.selectAll(\"rect.michaeldmoore-multistat-panel-bar.highflash\").interrupt();\r\n\t\t\t\t\tthis.svg.selectAll(\"rect.michaeldmoore-multistat-panel-bar.lowflash\").interrupt();\r\n\r\n\t\t\t\t\tvar id = this.panel.id;\r\n\t\t\t\t\tvar barPadding = this.panel.BarPadding;\r\n\t\t\t\t\tvar baseLineValue = this.panel.BaseLineValue;\r\n\t\t\t\t\tvar minLineValue = this.panel.MinLineValue;\r\n\t\t\t\t\tvar maxLineValue = this.panel.MaxLineValue;\r\n\t\t\t\t\tvar highBarColor = this.panel.HighBarColor;\r\n\t\t\t\t\tvar lowBarColor = this.panel.LowBarColor;\r\n\t\t\t\t\tvar highLimitValue = this.panel.HighLimitValue;\r\n\t\t\t\t\tvar HighLimitBarColor = this.panel.HighLimitBarColor;\r\n\t\t\t\t\tvar HighLimitBarFlashColor = this.panel.HighLimitBarFlashColor;\r\n\t\t\t\t\tvar HighLimitBarFlashTimeout = this.panel.HighLimitBarFlashTimeout;\r\n\t\t\t\t\tvar recolorHighLimitBar = this.panel.RecolorHighLimitBar;\r\n\t\t\t\t\tvar lowLimitValue = this.panel.LowLimitValue;\r\n\t\t\t\t\tvar LowLimitBarColor = this.panel.LowLimitBarColor;\r\n\t\t\t\t\tvar LowLimitBarFlashColor = this.panel.LowLimitBarFlashColor;\r\n\t\t\t\t\tvar LowLimitBarFlashTimeout = this.panel.LowLimitBarFlashTimeout;\r\n\t\t\t\t\tvar recolorLowLimitBar = this.panel.RecolorLowLimitBar;\r\n\t\t\t\t\tvar flashHighLimitBar = this.panel.FlashHighLimitBar;\r\n\t\t\t\t\tvar flashLowLimitBar = this.panel.FlashLowLimitBar;\r\n\t\t\t\t\tvar showTooltips = this.panel.ShowTooltips;\r\n\t\t\t\t\tvar DateTimeColName = this.panel.DateTimeColName;\r\n\t\t\t\t\tvar DateFormat = this.panel.DateFormat;\r\n\t\t\t\t\tvar TooltipDateFormat = this.panel.TooltipDateFormat;\r\n\t\t\t\t\tvar ValueColName = this.panel.ValueColName;\r\n\t\t\t\t\tvar ValueDecimals = this.panel.ValueDecimals;\r\n\t\t\t\t\tvar OddRowColor = this.panel.OddRowColor;\r\n\t\t\t\t\tvar EvenRowColor = this.panel.EvenRowColor;\r\n\t\t\t\t\tvar TZOffsetHours = this.panel.TZOffsetHours;\r\n\t\t\t\t\tvar GroupCols = this.panel.GroupCols;\r\n\t\t\t\t\tvar GroupGap = this.panel.GroupGap;\r\n\t\t\t\t\tvar ScaleFactor = Number(this.panel.ScaleFactor);\r\n\t\t\t\t\tvar LabelColor = this.panel.LabelColor;\r\n\t\t\t\t\tvar ValuePosition = this.panel.ValuePosition;\r\n\t\t\t\t\tvar DisplayMode = this.panel.DisplayMode;\r\n\r\n\t\t\t\t\tvar minValue = d3.min(this.rows, function(d) {\r\n\t\t\t\t\t\t\treturn Number(d[valueCol]) * ScaleFactor;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif ($.isNumeric(minLineValue) == false)\r\n\t\t\t\t\t\t\tminLineValue = minValue;\r\n\r\n\t\t\t\t\tvar maxValue = d3.max(this.rows, function(d) {\r\n\t\t\t\t\t\t\treturn Number(d[valueCol]) * ScaleFactor;\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif ($.isNumeric(maxLineValue) == false)\r\n\t\t\t\t\t\t\tmaxLineValue = maxValue;\r\n\r\n\t\t\t\t\tif ($.isNumeric(baseLineValue) == false)\r\n\t\t\t\t\t\t\tbaseLineValue = 0;\r\n\r\n\t\t\t\t\tif (minLineValue > baseLineValue)\r\n\t\t\t\t\t\t\tminLineValue = baseLineValue;\r\n\r\n\t\t\t\t\tif ($.isNumeric(lowLimitValue) && minLineValue > lowLimitValue)\r\n\t\t\t\t\t\t\tminLineValue = lowLimitValue;\r\n\r\n\t\t\t\t\tif (maxLineValue < baseLineValue)\r\n\t\t\t\t\t\t\tmaxLineValue = baseLineValue;\r\n\r\n\t\t\t\t\tif ($.isNumeric(highLimitValue) && maxLineValue < highLimitValue)\r\n\t\t\t\t\t\t\tmaxLineValue = highLimitValue;\r\n\r\n\t\t\t\t\td3.select(\"body\").append(\"div\")\r\n\t\t\t\t\t\t\t.attr(\"class\", \"michaeldmoore-multistat-panel-tooltip michaeldmoore-multistat-panel-tooltip-\" + id)\r\n\t\t\t\t\t\t\t.style(\"opacity\", 0);\r\n\r\n\t\t\t\t\tvar tooltipShow = function(d, c, id) {\r\n\t\t\t\t\t\t\tvar tooltipDiv = d3.select(\".michaeldmoore-multistat-panel-tooltip-\" + id);\r\n\t\t\t\t\t\t\ttooltipDiv.transition()\r\n\t\t\t\t\t\t\t\t\t.duration(200)\r\n\t\t\t\t\t\t\t\t\t.style(\"opacity\", 0.9);\r\n\t\t\t\t\t\t\tvar html = \"<table>\";\r\n\t\t\t\t\t\t\tfor (var i = 0; i < d.length; i++) {\r\n\t\t\t\t\t\t\t\t\tvar cc = c[i];\r\n\t\t\t\t\t\t\t\t\tvar dd = d[i];\r\n\r\n\t\t\t\t\t\t\t\t\tif (cc == DateTimeColName)\r\n\t\t\t\t\t\t\t\t\t\t\tdd = moment(dd).add(TZOffsetHours, 'h').format(TooltipDateFormat);\r\n\t\t\t\t\t\t\t\t\telse if (cc == ValueColName && $.isNumeric(dd))\r\n\t\t\t\t\t\t\t\t\t\t\tdd = Number(dd).toFixed(ValueDecimals);\r\n\r\n\t\t\t\t\t\t\t\t\thtml += \"<tr><td>\" + cc + \"</td><td>\" + dd + \"</td></tr>\";\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\thtml += \"</table>\";\r\n\t\t\t\t\t\t\ttooltipDiv.html(html)\r\n\t\t\t\t\t\t\t\t\t.style(\"left\", d3.event.pageX + \"px\")\r\n\t\t\t\t\t\t\t\t\t.style(\"top\", (d3.event.pageY - 28) + \"px\");\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tvar tooltipHide = function(id) {\r\n\t\t\t\t\t\t\tvar tooltipDiv = d3.selectAll(\".michaeldmoore-multistat-panel-tooltip-\" + id);\r\n\t\t\t\t\t\t\ttooltipDiv.transition()\r\n\t\t\t\t\t\t\t\t\t.duration(500)\r\n\t\t\t\t\t\t\t\t\t.style(\"opacity\", 0);\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tvar scaleAndClipValue = function(d) {\r\n\t\t\t\t\t\t\tvar val = d * ScaleFactor;\r\n\t\t\t\t\t\t\tif (val > maxLineValue)\r\n\t\t\t\t\t\t\t\t\tval = maxLineValue;\r\n\t\t\t\t\t\t\tif (val < minLineValue)\r\n\t\t\t\t\t\t\t\t\tval = minLineValue;\r\n\r\n\t\t\t\t\t\t\treturn val;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tif (horizontal) {\r\n\t\t\t\t\t\t\tvar plotGroupHorizontal = function(panel, svg, data, numRows, groupName, groupNameOffset, left, w, hh, dh) {\r\n\r\n\t\t\t\t\t\t\t\t\t// Draw border rectangle\r\n\t\t\t\t\t\t\t\t\t/*svg.append(\"rect\")\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"width\", w)\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"height\", dh)\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"x\", left)\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"y\", hh)\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"stroke\", \"yellow\");*/\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.SortDirection != \"none\") {\r\n\t\t\t\t\t\t\t\t\t\t\tvar ascending = panel.SortDirection == \"ascending\";\r\n\t\t\t\t\t\t\t\t\t\t\tdata.sort(function(x, y) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar comp = (x[sortCol] == y[sortCol]) ? 0 : ((x[sortCol] > y[sortCol]) ? 1 : -1);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn ascending ? comp : -comp;\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t// Add Above-High Side Group Names\r\n\t\t\t\t\t\t\t\t\tif (groupName != '' && panel.ShowGroupLabels) {\r\n\t\t\t\t\t\t\t\t\t\t\tsvg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.append(\"text\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.text(groupName)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"x\", left + (labelMargin + w) / 2)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"y\", hh + groupNameOffset / 2)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"font-family\", \"sans-serif\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"font-size\", panel.GroupLabelFontSize)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"fill\", panel.GroupLabelColor)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"background\", \"blue\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"text-anchor\", \"middle\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"dominant-baseline\", \"central\");\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\thh += groupNameOffset;\r\n\t\t\t\t\t\t\t\t\tdh -= groupNameOffset;\r\n\r\n\t\t\t\t\t\t\t\t\t// Draw border rectangle\r\n\t\t\t\t\t\t\t\t\t/*svg.append(\"rect\")\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"width\", w)\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"height\", dh)\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"x\", left)\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"y\", hh)\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"stroke\", \"#ffffff\");*/\r\n\r\n\t\t\t\t\t\t\t\t\tvar labels = data.map(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\treturn d[labelCol];\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\twhile (labels.length < numRows)\r\n\t\t\t\t\t\t\t\t\t\t\tlabels = labels.concat('_' + Math.random().toString(36).substr(2, 9));\r\n\r\n\t\t\t\t\t\t\t\t\tvar labelScale = d3.scaleBand()\r\n\t\t\t\t\t\t\t\t\t\t\t.domain(labels)\r\n\t\t\t\t\t\t\t\t\t\t\t.rangeRound([hh + highSideMargin, hh + dh - lowSideMargin])\r\n\t\t\t\t\t\t\t\t\t\t\t.paddingInner(barPadding / 100)\r\n\t\t\t\t\t\t\t\t\t\t\t.paddingOuter(barPadding / 200);\r\n\r\n\t\t\t\t\t\t\t\t\tvar stripedata = data.concat(d3.range(data.length, numRows));\r\n\r\n\t\t\t\t\t\t\t\t\tvar stripeScale = d3.scaleBand()\r\n\t\t\t\t\t\t\t\t\t\t\t.domain(stripedata)\r\n\t\t\t\t\t\t\t\t\t\t\t.rangeRound([hh + highSideMargin, hh + dh - lowSideMargin]);\r\n\r\n\t\t\t\t\t\t\t\t\t// Draw background of alternating stripes\r\n\t\t\t\t\t\t\t\t\tvar oddeven = false;\r\n\t\t\t\t\t\t\t\t\tsvg.append(\"g\")\r\n\t\t\t\t\t\t\t\t\t\t\t.selectAll(\"rect\")\r\n\t\t\t\t\t\t\t\t\t\t\t.data(stripedata)\r\n\t\t\t\t\t\t\t\t\t\t\t.enter()\r\n\t\t\t\t\t\t\t\t\t\t\t.append(\"rect\")\r\n\t\t\t\t\t\t\t\t\t\t\t.attr(\"class\", \"michaeldmoore-multistat-panel-row\")\r\n\t\t\t\t\t\t\t\t\t\t\t.attr(\"width\", w)\r\n\t\t\t\t\t\t\t\t\t\t\t.attr(\"height\", stripeScale.step())\r\n\t\t\t\t\t\t\t\t\t\t\t.attr(\"x\", left)\r\n\t\t\t\t\t\t\t\t\t\t\t.attr(\"y\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn stripeScale(d);\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t.attr(\"fill\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\toddeven = !oddeven;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn oddeven ? OddRowColor : EvenRowColor;\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t.on(\"mouseover\", function(d, i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (showTooltips && i < data.length)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipShow(d, cols, id);\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t.on(\"mouseout\", function() {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipHide(id);\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\tvar g1 = svg.append(\"g\")\r\n\t\t\t\t\t\t\t\t\t\t\t.selectAll(\"text\")\r\n\t\t\t\t\t\t\t\t\t\t\t.data(data)\r\n\t\t\t\t\t\t\t\t\t\t\t.enter()\r\n\t\t\t\t\t\t\t\t\t\t\t.append(\"g\");\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowValues && panel.ValuePosition == \"top\") {\r\n\t\t\t\t\t\t\t\t\t\t\tvar maxValueWidth = 0;\r\n\t\t\t\t\t\t\t\t\t\t\tg1.append(\"text\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.text(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (Number(d[valueCol]) * ScaleFactor).toFixed(ValueDecimals);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"x\", left + w)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"y\", function(d, i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn labelScale(d[labelCol]) + (labelScale.bandwidth() / 2);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"font-family\", \"sans-serif\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"font-size\", panel.ValueFontSize)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"fill\", panel.ValueColor)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"text-anchor\", \"end\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"dominant-baseline\", \"central\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.each(function(d, i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar thisWidth = this.getComputedTextLength();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmaxValueWidth = d3.max([maxValueWidth, thisWidth]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\tw -= maxValueWidth;\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowLabels) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar maxLabelWidth = 0;\r\n\t\t\t\t\t\t\t\t\t\t\tvar labelAngle = Number(panel.LableAngle);\r\n\t\t\t\t\t\t\t\t\t\t\tg1.append(\"text\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.text(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d[labelCol];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"font-family\", \"sans-serif\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"font-size\", panel.LabelFontSize)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"fill\", function(d, i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d[valueCol] * ScaleFactor > maxLineValue || d[valueCol] * ScaleFactor < minLineValue ? panel.OutOfRangeLabelColor : panel.LabelColor;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"text-anchor\", \"middle\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"dominant-baseline\", \"central\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"transform\", function(d, i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar bbox = this.getBBox();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar s = Math.sin(labelAngle * Math.PI / 180);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar c = Math.cos(labelAngle * Math.PI / 180);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar b = Math.abs(bbox.width * s) + Math.abs(bbox.height * c);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar a = Math.abs(bbox.width * c) + Math.abs(bbox.height * s);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar y = labelScale(d[labelCol]) + (labelScale.bandwidth() / 2);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar x = left + a / 2;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn \"translate(\" + x + \",\" + y + \") rotate(\" + labelAngle + \")\";\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.on(\"mouseover\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (showTooltips)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipShow(d, cols, id);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.on(\"mouseout\", function() {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipHide(id);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.each(function(d, i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar bbox = this.getBBox();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar s = Math.sin(labelAngle * Math.PI / 180);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar c = Math.cos(labelAngle * Math.PI / 180);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar b = Math.abs(bbox.width * s) + Math.abs(bbox.height * c);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar a = Math.abs(bbox.width * c) + Math.abs(bbox.height * s);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar thisWidth = a;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmaxLabelWidth = d3.max([maxLabelWidth, thisWidth]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif ($.isNumeric(labelMargin)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tleft += labelMargin;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tw -= labelMargin;\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tleft += maxLabelWidth;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tw -= maxLabelWidth;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tvar valueScale = d3.scaleLinear()\r\n\t\t\t\t\t\t\t\t\t\t\t.domain([minLineValue, maxLineValue])\r\n\t\t\t\t\t\t\t\t\t\t\t.range([left + labelMargin, left + w])\r\n\t\t\t\t\t\t\t\t\t\t\t.nice();\r\n\r\n\t\t\t\t\t\t\t\t\tfunction vLine(svg, value, color, strokeWidth) {\r\n\t\t\t\t\t\t\t\t\t\t\tsvg.append(\"line\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.style(\"stroke\", color)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"stroke-width\", strokeWidth == null ? 1 : strokeWidth)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"y1\", hh + highSideMargin)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"x1\", valueScale(value))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"y2\", hh + dh - lowSideMargin)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"x2\", valueScale(value));\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowBaseLine)\r\n\t\t\t\t\t\t\t\t\t\t\tvLine(svg, baseLineValue, panel.BaseLineColor, panel.BaseLineWidth);\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowMaxLine)\r\n\t\t\t\t\t\t\t\t\t\t\tvLine(svg, maxLineValue, panel.MaxLineColor, panel.MaxLineWidth);\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowMinLine)\r\n\t\t\t\t\t\t\t\t\t\t\tvLine(svg, minLineValue, panel.MinLineColor, panel.MinLineWidth);\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowHighLimitLine)\r\n\t\t\t\t\t\t\t\t\t\t\tvLine(svg, highLimitValue, panel.HighLimitLineColor, panel.HighLimitLineWidth);\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowLowLimitLine)\r\n\t\t\t\t\t\t\t\t\t\t\tvLine(svg, lowLimitValue, panel.LowLimitLineColor, panel.LowLimitLineWidth);\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowBars) {\r\n\t\t\t\t\t\t\t\t\t\t\tg1.append(\"rect\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"class\", \"michaeldmoore-multistat-panel-bar\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"width\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar val = scaleAndClipValue(d[valueCol]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn Math.abs(valueScale(val) - valueScale(baseLineValue));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"height\", labelScale.bandwidth())\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"x\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar val = scaleAndClipValue(d[valueCol]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d3.min([valueScale(val), valueScale(baseLineValue)]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"y\", function(d, i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn labelScale(d[labelCol]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"fill\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (recolorHighLimitBar && (d[valueCol] * ScaleFactor > highLimitValue))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn HighLimitBarColor;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (recolorLowLimitBar && (d[valueCol] * ScaleFactor < lowLimitValue))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn LowLimitBarColor;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (d[valueCol] * ScaleFactor > baseLineValue) ? highBarColor : lowBarColor;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.classed(\"highflash\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn recolorHighLimitBar && flashHighLimitBar && (d[valueCol] * ScaleFactor > highLimitValue);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.classed(\"lowflash\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn recolorLowLimitBar && flashLowLimitBar && (d[valueCol] * ScaleFactor < lowLimitValue);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.on(\"mouseover\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (showTooltips)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipShow(d, cols, id);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.on(\"mouseout\", function() {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipHide(id);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowLines) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (panel.LineWidth) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar points = [];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar bw = labelScale.step();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor (var i = 0; i < data.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar d = data[i];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar y = hh + highSideMargin + (i + 0.5) * bw;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar x = valueScale(d[valueCol]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpoints.push({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tx,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ty\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar curveFunc = d3.curveLinear;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tswitch (panel.CurveType) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'Linear':\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcurveFunc = d3.curveLinear;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'Monotone':\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcurveFunc = d3.curveMonotoneY;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'Cardinal':\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcurveFunc = d3.curveCardinal;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'Catmull-Rom':\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcurveFunc = d3.curveCatmullRom;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar lineFunction = d3.line()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.curve(curveFunc)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.x(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d.x;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.y(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d.y;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar lineGraph = svg.append(\"path\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"d\", lineFunction(points))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"stroke\", panel.LineColor)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"stroke-width\", panel.LineWidth)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"fill\", \"none\");\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif (panel.DotSize) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tg1.append(\"circle\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"r\", panel.DotSize / 2.0)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"fill\", panel.DotColor)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"cy\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn labelScale(d[labelCol]) + (bw * (1.0 - (barPadding/100.0)) / 2.0);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"cx\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn valueScale(d[valueCol]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowValues && panel.ValuePosition != \"top\") {\r\n\t\t\t\t\t\t\t\t\t\t\t\tg1.append(\"text\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.text(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (Number(d[valueCol]) * ScaleFactor).toFixed(ValueDecimals);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"x\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (panel.ValuePosition == \"bar base\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn valueScale(baseLineValue);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar val = scaleAndClipValue(d[valueCol]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn valueScale(val) + ((val > baseLineValue));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"y\", function(d, i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn labelScale(d[labelCol]) + (labelScale.bandwidth() / 2);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"font-family\", \"sans-serif\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"font-size\", panel.ValueFontSize)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"fill\", panel.ValueColor)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"text-anchor\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (panel.ValuePosition == \"bar base\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (d[valueCol] * ScaleFactor > baseLineValue) ? \"start\" : \"end\";\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (d[valueCol] * ScaleFactor > baseLineValue) ? \"end\" : \"start\";\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"dominant-baseline\", \"central\");\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t// Add High Side Value Axis (X)\r\n\t\t\t\t\t\t\t\t\tif (highSideMargin > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar ggHighSide = svg.append(\"g\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"transform\", 'translate(1,' + (hh + highSideMargin) + ')')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"class\", \"michaeldmoore-multistat-panel-valueaxis\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.call(d3.axisTop(valueScale));\r\n\t\t\t\t\t\t\t\t\t\t\tggHighSide.selectAll('.tick text').attr('fill', panel.HighAxisColor);\r\n\t\t\t\t\t\t\t\t\t\t\tggHighSide.selectAll('.tick line').attr('stroke', panel.HighAxisColor).attr('stroke-width', panel.HighAxisWidth);\r\n\t\t\t\t\t\t\t\t\t\t\tggHighSide.selectAll('path.domain').attr('stroke', panel.HighAxisColor).attr('stroke-width', panel.HighAxisWidth);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t// Add Low Side Value Axis (X)\r\n\t\t\t\t\t\t\t\t\tif (lowSideMargin > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar ggLowSide = svg.append(\"g\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"transform\", 'translate(0,' + (hh + dh - lowSideMargin) + ')')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"class\", \"michaeldmoore-multistat-panel-valueaxis\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.call(d3.axisBottom(valueScale));\r\n\t\t\t\t\t\t\t\t\t\t\tggLowSide.selectAll('.tick text').attr('fill', panel.LowAxisColor);\r\n\t\t\t\t\t\t\t\t\t\t\tggLowSide.selectAll('.tick line').attr('stroke', panel.LowAxisColor).attr('stroke-width', panel.LowAxisWidth);\r\n\t\t\t\t\t\t\t\t\t\t\tggLowSide.selectAll('path.domain').attr('stroke', panel.LowAxisColor).attr('stroke-width', panel.LowAxisWidth);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\tif (this.groupedRows != null) {\r\n\t\t\t\t\t\t\t\t\tvar gcols = (GroupCols <= 0 || GroupCols > this.groupedRows.length) ? this.groupedRows.length : GroupCols;\r\n\t\t\t\t\t\t\t\t\tvar dw = ((w + GroupGap) / gcols);\r\n\r\n\t\t\t\t\t\t\t\t\t// Figure out the max data points in each row of groups...\r\n\t\t\t\t\t\t\t\t\tvar pointsPerRow = [];\r\n\t\t\t\t\t\t\t\t\tfor (let i = 0; i < this.groupedRows.length / gcols; i++)\r\n\t\t\t\t\t\t\t\t\t\t\tpointsPerRow.push(0);\r\n\t\t\t\t\t\t\t\t\tfor (let i = 0; i < this.groupedRows.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\t\tlet rr = Math.floor(i / gcols);\r\n\t\t\t\t\t\t\t\t\t\t\tlet u = this.groupedRows[i].values.length;\r\n\t\t\t\t\t\t\t\t\t\t\tif (pointsPerRow[rr] < u)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpointsPerRow[rr] = u;\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tvar totalPoints = 0;\r\n\t\t\t\t\t\t\t\t\tfor (let i = 0; i < pointsPerRow.length; i++)\r\n\t\t\t\t\t\t\t\t\t\t\ttotalPoints += pointsPerRow[i];\r\n\r\n\t\t\t\t\t\t\t\t\tvar rowOverheadHeight = groupNameOffset + this.panel.LowSideMargin + this.panel.HighSideMargin;\r\n\t\t\t\t\t\t\t\t\tvar rowHeight = (h - (pointsPerRow.length * rowOverheadHeight)) / totalPoints;\r\n\r\n\t\t\t\t\t\t\t\t\tvar numRows = Math.ceil(this.groupedRows.length / gcols);\r\n\t\t\t\t\t\t\t\t\tvar hh = 0;\r\n\t\t\t\t\t\t\t\t\tfor (var rr = 0; rr < numRows; rr++) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar nn = pointsPerRow[rr];\r\n\t\t\t\t\t\t\t\t\t\t\tvar dh = rowOverheadHeight + (nn * rowHeight);\r\n\t\t\t\t\t\t\t\t\t\t\thh += dh;\r\n\t\t\t\t\t\t\t\t\t\t\tfor (var cc = 0; cc < gcols; cc++) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar ii = cc + (rr * gcols);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (ii < this.groupedRows.length) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplotGroupHorizontal(this.panel, this.svg, this.groupedRows[ii].values, nn, this.groupedRows[ii].key, groupNameOffset,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcc * dw, dw - GroupGap, hh - dh, dh);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tplotGroupHorizontal(this.panel, this.svg, this.rows, this.rows.length, '', 0, 0, w, 0, h);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar plotGroupVertical = function(panel, svg, data, numRows, groupName, groupNameOffset, left, w, hh, dh) {\r\n\t\t\t\t\t\t\t\t\t// Draw border rectangle\r\n\t\t\t\t\t\t\t\t\t/*svg.append(\"rect\")\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"width\", w)\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"height\", dh)\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"x\", left)\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"y\", hh)\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"stroke\", \"yellow\");*/\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.SortDirection != \"none\") {\r\n\t\t\t\t\t\t\t\t\t\t\tvar ascending = panel.SortDirection == \"ascending\";\r\n\t\t\t\t\t\t\t\t\t\t\tdata.sort(function(x, y) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar comp = (x[sortCol] == y[sortCol]) ? 0 : ((x[sortCol] > y[sortCol]) ? 1 : -1);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn ascending ? comp : -comp;\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t// Add Above-High Side Group Names\r\n\t\t\t\t\t\t\t\t\tif (groupName != '' && panel.ShowGroupLabels) {\r\n\t\t\t\t\t\t\t\t\t\t\tsvg\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.append(\"text\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.text(groupName)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"x\", left + (labelMargin + w) / 2)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"y\", hh + groupNameOffset / 2)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"font-family\", \"sans-serif\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"font-size\", panel.GroupLabelFontSize)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"fill\", panel.GroupLabelColor)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"background\", \"blue\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"text-anchor\", \"middle\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"dominant-baseline\", \"central\");\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\thh += groupNameOffset;\r\n\t\t\t\t\t\t\t\t\tdh -= groupNameOffset;\r\n\r\n\t\t\t\t\t\t\t\t\t// Draw border rectangle\r\n\t\t\t\t\t\t\t\t\t/*svg.append(\"rect\")\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"width\", w)\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"height\", dh)\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"x\", left)\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"y\", hh)\r\n\t\t\t\t\t\t\t\t\t\t.attr(\"stroke\", \"#ffffff\");*/\r\n\r\n\r\n\t\t\t\t\t\t\t\t\tvar labels = data.map(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\treturn d[labelCol];\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\twhile (labels.length < numRows)\r\n\t\t\t\t\t\t\t\t\t\t\tlabels = labels.concat('_' + Math.random().toString(36).substr(2, 9));\r\n\r\n\t\t\t\t\t\t\t\t\tvar labelScale = d3.scaleBand()\r\n\t\t\t\t\t\t\t\t\t\t\t.domain(labels)\r\n\t\t\t\t\t\t\t\t\t\t\t.range([left + lowSideMargin, left + w - highSideMargin])\r\n\t\t\t\t\t\t\t\t\t\t\t.paddingInner(barPadding / 100)\r\n\t\t\t\t\t\t\t\t\t\t\t.paddingOuter(barPadding / 200);\r\n\r\n\t\t\t\t\t\t\t\t\tvar stripedata = data.concat(d3.range(data.length, numRows));\r\n\r\n\t\t\t\t\t\t\t\t\tvar stripeScale = d3.scaleBand()\r\n\t\t\t\t\t\t\t\t\t\t\t.domain(stripedata)\r\n\t\t\t\t\t\t\t\t\t\t\t.range([left + lowSideMargin, left + w - highSideMargin]);\r\n\r\n\t\t\t\t\t\t\t\t\t// Draw background of alternating stripes\r\n\t\t\t\t\t\t\t\t\tvar oddeven = false;\r\n\t\t\t\t\t\t\t\t\tsvg.append(\"g\")\r\n\t\t\t\t\t\t\t\t\t\t\t.selectAll(\"rect\")\r\n\t\t\t\t\t\t\t\t\t\t\t.data(stripedata)\r\n\t\t\t\t\t\t\t\t\t\t\t.enter()\r\n\t\t\t\t\t\t\t\t\t\t\t.append(\"rect\")\r\n\t\t\t\t\t\t\t\t\t\t\t.attr(\"class\", \"michaeldmoore-multistat-panel-row\")\r\n\t\t\t\t\t\t\t\t\t\t\t.attr(\"width\", stripeScale.step())\r\n\t\t\t\t\t\t\t\t\t\t\t.attr(\"height\", dh)\r\n\t\t\t\t\t\t\t\t\t\t\t.attr(\"x\", function(d, i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn stripeScale(d);\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t.attr(\"y\", hh)\r\n\t\t\t\t\t\t\t\t\t\t\t.attr(\"fill\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\toddeven = !oddeven;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn oddeven ? OddRowColor : EvenRowColor;\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t.on(\"mouseover\", function(d, i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (showTooltips && i < data.length)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipShow(d, cols, id);\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t.on(\"mouseout\", function() {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipHide(id);\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\tvar g2 = svg.append(\"g\")\r\n\t\t\t\t\t\t\t\t\t\t\t.selectAll(\"text\")\r\n\t\t\t\t\t\t\t\t\t\t\t.data(data)\r\n\t\t\t\t\t\t\t\t\t\t\t.enter()\r\n\t\t\t\t\t\t\t\t\t\t\t.append(\"g\");\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowValues && panel.ValuePosition == \"top\") {\r\n\t\t\t\t\t\t\t\t\t\t\tvar maxValueHeight = 0;\r\n\t\t\t\t\t\t\t\t\t\t\tg2.append(\"text\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.text(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (Number(d[valueCol]) * ScaleFactor).toFixed(ValueDecimals);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"x\", function(d, i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn labelScale(d[labelCol]) + (labelScale.bandwidth() / 2);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"y\", hh)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"font-family\", \"sans-serif\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"font-size\", panel.ValueFontSize)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"fill\", panel.ValueColor)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"text-anchor\", \"middle\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"dominant-baseline\", \"text-before-edge\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.each(function(d, i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar thisHeight = this.getBBox().height;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmaxValueHeight = d3.max([maxValueHeight, thisHeight]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\thh += maxValueHeight;\r\n\t\t\t\t\t\t\t\t\t\t\tdh -= maxValueHeight;\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowLabels) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar maxLabelHeight = 0;\r\n\t\t\t\t\t\t\t\t\t\t\tvar labelAngle = Number(panel.LableAngle);\r\n\t\t\t\t\t\t\t\t\t\t\tg2.append(\"text\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.text(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d[labelCol];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"font-family\", \"sans-serif\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"font-size\", panel.LabelFontSize)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"fill\", function(d, i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d[valueCol] * ScaleFactor > maxLineValue || d[valueCol] * ScaleFactor < minLineValue ? panel.OutOfRangeLabelColor : LabelColor;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"text-anchor\", \"middle\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"dominant-baseline\", \"central\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"transform\", function(d, i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar bbox = this.getBBox();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar s = Math.sin(labelAngle * Math.PI / 180);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar c = Math.cos(labelAngle * Math.PI / 180);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar b = Math.abs(bbox.width * s) + Math.abs(bbox.height * c);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar a = Math.abs(bbox.width * c) + Math.abs(bbox.height * s);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar x = labelScale(d[labelCol]) + (labelScale.bandwidth() / 2);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar y = hh + dh - b / 2;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn \"translate(\" + x + \",\" + y + \") rotate(\" + labelAngle + \")\";\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.on(\"mouseover\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (showTooltips)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipShow(d, cols, id);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.on(\"mouseout\", function() {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipHide(id);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.each(function(d, i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar bbox = this.getBBox();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar s = Math.sin(labelAngle * Math.PI / 180);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar c = Math.cos(labelAngle * Math.PI / 180);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar b = Math.abs(bbox.width * s) + Math.abs(bbox.height * c);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar a = Math.abs(bbox.width * c) + Math.abs(bbox.height * s);\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar thisHeight = b;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmaxLabelHeight = d3.max([maxLabelHeight, thisHeight]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\tif ($.isNumeric(labelMargin)) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdh -= labelMargin;\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tdh -= maxLabelHeight;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tvar valueScale = d3.scaleLinear()\r\n\t\t\t\t\t\t\t\t\t\t\t.domain([maxLineValue, minLineValue])\r\n\t\t\t\t\t\t\t\t\t\t\t.range([hh, hh + dh])\r\n\t\t\t\t\t\t\t\t\t\t\t.nice();\r\n\r\n\t\t\t\t\t\t\t\t\tfunction hLine(svg, value, color, strokeWidth) {\r\n\t\t\t\t\t\t\t\t\t\t\tsvg.append(\"line\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.style(\"stroke\", color)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"stroke-width\", strokeWidth == null ? 1 : strokeWidth)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"x1\", left + lowSideMargin)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"y1\", valueScale(value))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"x2\", left + w - highSideMargin)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"y2\", valueScale(value));\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowBaseLine)\r\n\t\t\t\t\t\t\t\t\t\t\thLine(svg, baseLineValue, panel.BaseLineColor, panel.BaseLineWidth);\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowMaxLine)\r\n\t\t\t\t\t\t\t\t\t\t\thLine(svg, maxLineValue, panel.MaxLineColor, panel.MaxLineWidth);\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowMinLine)\r\n\t\t\t\t\t\t\t\t\t\t\thLine(svg, minLineValue, panel.MinLineColor, panel.MinLineWidth);\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowHighLimitLine)\r\n\t\t\t\t\t\t\t\t\t\t\thLine(svg, highLimitValue, panel.HighLimitLineColor, panel.HighLimitLineWidth);\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowLowLimitLine)\r\n\t\t\t\t\t\t\t\t\t\t\thLine(svg, lowLimitValue, panel.LowLimitLineColor, panel.LowLimitLineWidth);\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowBars) {\r\n\t\t\t\t\t\t\t\t\t\t\tg2.append(\"rect\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"class\", \"michaeldmoore-multistat-panel-bar\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"height\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar val = scaleAndClipValue(d[valueCol]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn Math.abs(valueScale(baseLineValue) - valueScale(val));\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"width\", labelScale.bandwidth())\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"y\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar val = scaleAndClipValue(d[valueCol]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d3.min([valueScale(val), valueScale(baseLineValue)]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"x\", function(d, i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn labelScale(d[labelCol]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"fill\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (recolorHighLimitBar && (d[valueCol] * ScaleFactor > highLimitValue))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn HighLimitBarColor;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (recolorLowLimitBar && (d[valueCol] * ScaleFactor < lowLimitValue))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn LowLimitBarColor;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (d[valueCol] * ScaleFactor > baseLineValue) ? highBarColor : lowBarColor;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.classed(\"highflash\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn recolorHighLimitBar && flashHighLimitBar && (d[valueCol] * ScaleFactor > highLimitValue);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.classed(\"lowflash\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn recolorLowLimitBar && flashLowLimitBar && (d[valueCol] * ScaleFactor < lowLimitValue);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.on(\"mouseover\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (showTooltips)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipShow(d, cols, id);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.on(\"mouseout\", function() {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttooltipHide(id);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowLines) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (panel.LineWidth) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar points = [];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar bw = labelScale.step();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tfor (var i = 0; i < data.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar d = data[i];\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar x = left + lowSideMargin + (i + 0.5) * bw;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar y = valueScale(d[valueCol]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tpoints.push({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tx,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ty\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar curveFunc = d3.curveLinear;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tswitch (panel.CurveType) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'Linear':\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcurveFunc = d3.curveLinear;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'Monotone':\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcurveFunc = d3.curveMonotoneX;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'Cardinal':\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcurveFunc = d3.curveCardinal;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcase 'Catmull-Rom':\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcurveFunc = d3.curveCatmullRom;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar lineFunction = d3.line()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.curve(curveFunc)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.x(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d.x;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.y(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn d.y;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tvar lineGraph = svg.append(\"path\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"d\", lineFunction(points))\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"stroke\", panel.LineColor)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"stroke-width\", panel.LineWidth)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"fill\", \"none\");\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\tif (panel.DotSize) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tg2.append(\"circle\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"r\", panel.DotSize / 2.0)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"fill\", panel.DotColor)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"cx\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn labelScale(d[labelCol]) + (bw * (1.0 - (barPadding/100.0)) / 2.0);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"cy\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn valueScale(d[valueCol]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (panel.ShowValues && panel.ValuePosition != \"top\") {\r\n\t\t\t\t\t\t\t\t\t\t\tg2.append(\"text\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t.text(function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (Number(d[valueCol]) * ScaleFactor).toFixed(ValueDecimals);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"x\", function(d, i) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn labelScale(d[labelCol]) + (labelScale.bandwidth() / 2);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"y\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (ValuePosition == \"bar base\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn valueScale(baseLineValue);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar val = scaleAndClipValue(d[valueCol]);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn valueScale(val);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"font-family\", \"sans-serif\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"font-size\", panel.ValueFontSize)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"fill\", panel.ValueColor)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"text-anchor\", \"middle\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr(\"dominant-baseline\", function(d) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif (ValuePosition == \"bar base\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (d[valueCol] * ScaleFactor > baseLineValue) ? \"text-after-edge\" : \"text-before-edge\";\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (d[valueCol] * ScaleFactor > baseLineValue) ? \"text-before-edge\" : \"text-after-edge\";\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (lowSideMargin > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\tlet ggLowSide = svg.append(\"g\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr('transform', 'translate(' + (left + lowSideMargin) + ', 0)')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.classed('michaeldmoore-multistat-panel-valueaxis', true)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.call(d3.axisLeft(valueScale).tickSizeInner(5).tickSizeOuter(10).ticks(5));\r\n\t\t\t\t\t\t\t\t\t\t\tggLowSide.selectAll('.tick text').attr('fill', panel.LowAxisColor);\r\n\t\t\t\t\t\t\t\t\t\t\tggLowSide.selectAll('.tick line').attr('stroke', panel.LowAxisColor).attr('stroke-width', panel.LowAxisWidth);\r\n\t\t\t\t\t\t\t\t\t\t\tggLowSide.selectAll('path.domain').attr('stroke', panel.LowAxisColor).attr('stroke-width', panel.LowAxisWidth);\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tif (highSideMargin > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\tlet ggHighSide = svg.append(\"g\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.attr('transform', 'translate(' + (left + w - highSideMargin) + ', 0)')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.classed('michaeldmoore-multistat-panel-valueaxis', true)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t.call(d3.axisRight(valueScale).tickSizeInner(5).tickSizeOuter(10).ticks(5));\r\n\t\t\t\t\t\t\t\t\t\t\tggHighSide.selectAll('.tick text').attr('fill', panel.HighAxisColor);\r\n\t\t\t\t\t\t\t\t\t\t\tggHighSide.selectAll('.tick line').attr('stroke', panel.HighAxisColor).attr('stroke-width', panel.HighAxisWidth);\r\n\t\t\t\t\t\t\t\t\t\t\tggHighSide.selectAll('path.domain').attr('stroke', panel.HighAxisColor).attr('stroke-width', panel.HighAxisWidth);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t};\r\n\r\n\r\n\t\t\t\t\t\t\tlet groupNameOffset = this.panel.ShowGroupLabels ? Number(this.panel.GroupLabelFontSize.replace('%', '')) * 0.15 : 0;\r\n\r\n\t\t\t\t\t\t\tif (this.groupedRows != null) {\r\n\t\t\t\t\t\t\t\t\tlet gcols = (GroupCols <= 0 || GroupCols > this.groupedRows.length) ? this.groupedRows.length : GroupCols;\r\n\t\t\t\t\t\t\t\t\tlet dw = ((w + GroupGap) / gcols);\r\n\r\n\t\t\t\t\t\t\t\t\t// Figure out the max data points in each column of groups...\r\n\t\t\t\t\t\t\t\t\tvar pointsPerCol = [];\r\n\t\t\t\t\t\t\t\t\tfor (let i = 0; i < gcols; i++)\r\n\t\t\t\t\t\t\t\t\t\t\tpointsPerCol.push(0);\r\n\t\t\t\t\t\t\t\t\tfor (let i = 0; i < this.groupedRows.length; i++) {\r\n\t\t\t\t\t\t\t\t\t\t\tlet cc = i % gcols;\r\n\t\t\t\t\t\t\t\t\t\t\tlet u = this.groupedRows[i].values.length;\r\n\t\t\t\t\t\t\t\t\t\t\tif (pointsPerCol[cc] < u)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tpointsPerCol[cc] = u;\r\n\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\tlet totalPoints = 0;\r\n\t\t\t\t\t\t\t\t\tfor (let i = 0; i < pointsPerCol.length; i++)\r\n\t\t\t\t\t\t\t\t\t\t\ttotalPoints += pointsPerCol[i];\r\n\r\n\t\t\t\t\t\t\t\t\tvar colOverheadWidth = this.panel.LowSideMargin + this.panel.HighSideMargin;\r\n\t\t\t\t\t\t\t\t\tvar colWidth = (w - (pointsPerCol.length * colOverheadWidth)) / totalPoints;\r\n\r\n\t\t\t\t\t\t\t\t\tlet numRows = Math.ceil(this.groupedRows.length / gcols);\r\n\t\t\t\t\t\t\t\t\tlet dh = h / numRows;\r\n\t\t\t\t\t\t\t\t\tlet hh = dh;\r\n\t\t\t\t\t\t\t\t\tfor (let rr = 0; rr < numRows; rr++) {\r\n\t\t\t\t\t\t\t\t\t\t\tlet ww = 0;\r\n\t\t\t\t\t\t\t\t\t\t\tfor (let cc = 0; cc < gcols; cc++) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet nn = pointsPerCol[cc];\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tlet ii = cc + (rr * gcols);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (ii < this.groupedRows.length) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tplotGroupVertical(this.panel, this.svg, this.groupedRows[ii].values, nn, this.groupedRows[ii].key, groupNameOffset,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tww, dw - GroupGap, hh - dh, dh);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tww += dw;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\thh += dh;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tplotGroupVertical(this.panel, this.svg, this.rows, this.rows.length, '', 0, 0, w, 0, h);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar pulseHigh = function(svg) {\r\n\t\t\t\t\t\t\tvar highFlashRects = svg.selectAll(\"rect.michaeldmoore-multistat-panel-bar.highflash\");\r\n\r\n\t\t\t\t\t\t\tif ($.isNumeric(HighLimitBarFlashTimeout) && highFlashRects._groups.length > 0 && highFlashRects._groups[0].length > 0) {\r\n\t\t\t\t\t\t\t\t\thighFlashRects\r\n\t\t\t\t\t\t\t\t\t\t\t.transition()\r\n\t\t\t\t\t\t\t\t\t\t\t.on(\"start\", function highRepeat() {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td3.active(this)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.style(\"fill\", HighLimitBarFlashColor)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.duration(HighLimitBarFlashTimeout)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.transition()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.style(\"fill\", HighLimitBarColor)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.duration(HighLimitBarFlashTimeout)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.transition()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.on(\"start\", highRepeat);\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tvar pulseLow = function(svg) {\r\n\t\t\t\t\t\t\tvar lowFlashRects = svg.selectAll(\"rect.michaeldmoore-multistat-panel-bar.lowflash\");\r\n\t\t\t\t\t\t\tif ($.isNumeric(LowLimitBarFlashTimeout) && lowFlashRects._groups.length > 0 && lowFlashRects._groups[0].length > 0) {\r\n\t\t\t\t\t\t\t\t\tlowFlashRects\r\n\t\t\t\t\t\t\t\t\t\t\t.transition()\r\n\t\t\t\t\t\t\t\t\t\t\t.on(\"start\", function lowRepeat() {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\td3.active(this)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.style(\"fill\", LowLimitBarFlashColor)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.duration(LowLimitBarFlashTimeout)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.transition()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.style(\"fill\", LowLimitBarColor)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.duration(LowLimitBarFlashTimeout)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.transition()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.on(\"start\", lowRepeat);\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tpulseHigh(this.svg);\r\n\t\t\t\t\tpulseLow(this.svg);\r\n\t\t\t} else\r\n\t\t\t\t\tthis.displayStatusMessage(\"No data\");\r\n\r\n\t\t\t// console.log((new XMLSerializer()).serializeToString(this.svg.node()));\r\n\r\n\t\t\tthis.ctrl.renderingCompleted();\r\n\t}\r\n\r\n\tonConfigChanged() {\r\n\t\t\tthis.refresh();\r\n\t}\r\n\r\n\tlink(scope, elem, attrs, ctrl) {\r\n\t\t\tthis.ctrl = ctrl;\r\n\t\t\tthis.elem = elem;\r\n\r\n\t\t\t// for backward compatability (grafana 6.6.0 and earlier)\r\n\t\t\tvar panelContentElem = elem.find('.panel-content');\r\n\t\t\tif (panelContentElem.length)\r\n\t\t\t\tthis.elem = panelContentElem;\r\n\t}\r\n}\r\n\r\nMultistatPanelCtrl.templateUrl = 'module.html';\r\n\r\nexport {\r\n\tMultistatPanelCtrl as PanelCtrl\r\n};"]}